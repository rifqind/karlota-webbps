import{q as z,j as i,C as J,k as D,h as Q,s as W,f as d,o as u,a as r,c as X,g as w,u as l,m as Y,w as y,b as t,e as b,v as m,B as c,F as N,p as Z,t as p,d as j}from"./app-CZMwUBW3.js";import{t as ee,S as te,s as E}from"./multiselect-BgQLsUwX.js";import{F as ae}from"./FlashFetch-Dkr2vR2D.js";import{M as I}from"./ModalBs-CCoKvqFs.js";import{P as se}from"./Pagination-CXLjvPdH.js";import{d as oe}from"./debounce-CD1Fzea3.js";import{G as le}from"./GeneralLayout-BZDJ3jBS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./karlota-logo-Gt799DZz.js";const re={class:"mb-2 flex flex-wrap items-center justify-between"},ne={class:"flex items-center w-full md:w-full lg:w-auto"},ie={class:"btn-success-fordone mr-2 mb-2 lg:mb-0",title:"Download"},ue={class:"table-responsive-mobile overflow-x-auto"},de={class:"table border-2 mb-2 w-full",ref:"tabelUser",id:"tabel-user"},pe={class:"bg-info-fordone"},me={class:""},ce={class:"search-header"},fe={class:"search-header"},ve={class:"search-header"},be={class:"text-center"},ke=["onClick"],ge=["onClick"],we={key:1},ye={class:"form-group"},xe={class:"mb-3 space-y-2"},he={key:0,class:"mb-3 text-red-500"},_e={class:"mb-3 space-y-2"},Ce={key:1,class:"mb-3 text-red-500"},Pe={class:"mb-3 space-y-2"},Ve={key:2,class:"mb-3 text-red-500"},Se={class:"mb-3 space-y-2"},Be={key:3,class:"mb-3 text-red-500"},Ue={class:"mb-3 space-y-2"},Fe={class:"mb-3 space-y-2"},Oe={__name:"Index",setup(De){const k=z();var T=k.props.user.data;const x=i(T),g=i(!1),h=i(!1),_=i(null),C=i(null),P=i(null),a=J({_token:null,id:null,name:null,email:null,satker_id:null,role:null,password:null,password_confirmation:null}),V=i([]),A=s=>{V.value=s,V.value.forEach((e,v)=>{setTimeout(()=>{V.value.shift()},(v+1)*1200)})};D([{key:"name",valueFilter:_},{key:"satker",valueFilter:C},{key:"role",valueFilter:P}].map(s=>s.valueFilter),function(){S.value=1,$()});const $=oe(()=>{f()}),B=i(10),S=i(1),K=s=>{B.value=s,f()},H=s=>{S.value=s,f()},U=i(k.props.countData);D(()=>k.props.countData,s=>{U.value=s});const M=Q(()=>x.value);D(()=>k.props.user.data,s=>{x.value=s});const f=async()=>{try{const s=await axios.get(route("user.index"),{params:{currentPage:S.value,paginated:B.value,ArrayFilter:{name:_.value,satker:C.value,role:P.value},orderAttribute:n.value}});x.value=s.data.user.data,U.value=s.data.countData}catch(s){console.error("Error fetching data: ",s)}},n=i({before:null,label:null,value:"asc"}),F=s=>{n.value.label=s,n.value.before==null||n.value.before==s?n.value.value=="asc"?n.value.value="desc":n.value.value=="desc"?n.value.value=null:n.value.value="asc":n.value.value="asc",n.value.before=s,f()},O=async()=>{const s=await axios.get(route("token"));a._token=s.data,!a.processing&&a.post(route("user.store"),{onSuccess:e=>{f(),g.value=!1,A(e.props.notification)}})},R=async()=>{const s=await axios.get(route("token"));a._token=s.data,!a.processing&&a.delete(route("user.destroy",{id:a.id}),{onSuccess:e=>{f(),h.value=!1,A(e.props.notification)}})},G=async s=>{try{const e=await axios.get(route("user.fetch",{id:s}));a.id=e.data.data.id,a.name=e.data.data.name,a.email=e.data.data.email,a.satker_id=e.data.data.satker_id,a.role=e.data.data.role,g.value=!0}catch(e){console.error(e)}},L=async s=>{try{const e=await axios.get(route("user.fetch",{id:s}));a.id=e.data.data.id,h.value=!0}catch(e){console.error(e)}};return(s,e)=>{const v=W("font-awesome-icon");return u(),d(N,null,[r(l(Y),{title:"Daftar Pengguna"}),l(ee)?(u(),X(te,{key:0})):w("",!0),r(le,null,{default:y(()=>[r(ae,{notifications:V.value},null,8,["notifications"]),t("div",re,[e[16]||(e[16]=t("div",{class:"text-xl font-bold w-full md:w-full lg:w-auto mb-2 md:mb-2 lg:mb-0"}," Daftar Pengguna ",-1)),t("div",ne,[t("button",ie,[r(v,{icon:"fa-solid fa-circle-down"})]),t("button",{onClick:e[0]||(e[0]=o=>g.value=!0),class:"btn-info-fordone mb-2 lg:mb-0"},[r(v,{icon:"fa-solid fa-plus"}),e[15]||(e[15]=b(" Tambah Pengguna Baru "))])])]),t("div",ue,[t("table",de,[t("thead",null,[t("tr",pe,[e[17]||(e[17]=t("th",{class:"first-column"},"No.",-1)),t("th",{class:"text-center th-order tabel-width-20",onClick:e[1]||(e[1]=o=>F("name"))}," Nama "),t("th",{class:"text-center th-order",onClick:e[2]||(e[2]=o=>F("satker"))},"Satker"),t("th",{class:"text-center th-order",onClick:e[3]||(e[3]=o=>F("role"))},"Role"),e[18]||(e[18]=t("th",{class:"text-center th-order deleted"},"Edit/Hapus",-1))]),t("tr",me,[e[19]||(e[19]=t("td",{class:"search-header"},null,-1)),t("td",ce,[m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>_.value=o),type:"text",class:"input-fordone w-full"},null,512),[[c,_.value,void 0,{trim:!0}]])]),t("td",fe,[m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>C.value=o),type:"text",class:"input-fordone w-full"},null,512),[[c,C.value,void 0,{trim:!0}]])]),t("td",ve,[m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>P.value=o),type:"text",class:"input-fordone w-full"},null,512),[[c,P.value,void 0,{trim:!0}]])]),e[20]||(e[20]=t("td",{class:"search-header deleted"},null,-1))])]),t("tbody",null,[x.value.length>0?(u(!0),d(N,{key:0},Z(M.value,o=>(u(),d("tr",{key:o.id},[t("td",null,p(o.number),1),t("td",null,p(o.name),1),t("td",null,p(o.satker),1),t("td",null,p(o.role),1),t("td",be,[t("a",{onClick:q=>G(o.id)},[r(v,{icon:"fa-solid fa-pencil",class:"edit-pen mx-2",title:"Cek/Edit"})],8,ke),t("a",{onClick:q=>L(o.id)},[r(v,{icon:"fa-solid fa-trash-can",class:"icon-trash-color mx-2",title:"Hapus"})],8,ge)])]))),128)):(u(),d("tr",we,e[21]||(e[21]=[t("td",{colspan:"9",class:"text-center"},"Data Tidak Ada",-1)])))])],512)]),r(se,{"onUpdate:currentPage":H,"onUpdate:showItems":K,"show-items":B.value,"total-items":U.value,"current-page":S.value,"current-show-items":M.value.length},null,8,["show-items","total-items","current-page","current-show-items"]),r(I,{ModalStatus:g.value,onClose:e[13]||(e[13]=()=>{g.value=!1,l(a).reset()}),title:"Tambah Pengguna Baru",modalSize:"min-w-[40vw]",modalPosition:"items-start pt-5"},{modalBody:y(()=>[t("div",ye,[t("div",xe,[e[22]||(e[22]=t("label",{for:"pdrb"},"Nama",-1)),m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>l(a).name=o),placeholder:"Isikan Nama Akun",class:"input-fordone w-full",type:"text"},null,512),[[c,l(a).name]])]),l(a).errors.name?(u(),d("div",he,p(l(a).errors.name),1)):w("",!0),t("div",_e,[e[23]||(e[23]=t("label",{for:"pdrb"},[b("Email"),t("span",{class:"text-danger"},"*")],-1)),m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>l(a).email=o),placeholder:"Isikan Email",class:"input-fordone w-full",type:"email"},null,512),[[c,l(a).email]])]),l(a).errors.email?(u(),d("div",Ce,p(l(a).errors.email),1)):w("",!0),t("div",Pe,[e[24]||(e[24]=t("label",{for:"pdrb"},[b("Kabupaten/Kota"),t("span",{class:"text-danger"},"*")],-1)),r(l(E),{modelValue:l(a).satker_id,"onUpdate:modelValue":e[9]||(e[9]=o=>l(a).satker_id=o),options:l(k).props.satker,searchable:!0,placeholder:"-- Pilih Kabupaten/Kota --"},null,8,["modelValue","options"])]),l(a).errors.satker_id?(u(),d("div",Ve,p(l(a).errors.satker_id),1)):w("",!0),t("div",Se,[e[25]||(e[25]=t("label",{for:"pdrb"},[b("Role"),t("span",{class:"text-danger"},"*")],-1)),r(l(E),{modelValue:l(a).role,"onUpdate:modelValue":e[10]||(e[10]=o=>l(a).role=o),options:[{label:"User",value:"user"},{label:"Admin",value:"admin"}],searchable:!0,placeholder:"-- Pilih Role --"},null,8,["modelValue"])]),l(a).errors.role?(u(),d("div",Be,p(l(a).errors.role),1)):w("",!0),t("div",Ue,[e[26]||(e[26]=t("label",{for:"pdrb"},[b("Password"),t("span",{class:"text-danger"},"*")],-1)),m(t("input",{type:"password",placeholder:"Boleh dikosongkan jika update user","onUpdate:modelValue":e[11]||(e[11]=o=>l(a).password=o),class:"input-fordone w-full"},null,512),[[c,l(a).password]])]),t("div",Fe,[e[27]||(e[27]=t("label",{for:"pdrb"},[b("Konfirmasi Password"),t("span",{class:"text-danger"},"*")],-1)),m(t("input",{type:"password",placeholder:"Boleh dikosongkan jika update user","onUpdate:modelValue":e[12]||(e[12]=o=>l(a).password_confirmation=o),class:"input-fordone w-full"},null,512),[[c,l(a).password_confirmation]])])])]),modalFunction:y(()=>[t("button",{type:"button",class:"btn-success-fordone btn-sm",onClick:j(O,["prevent"])}," Simpan ")]),_:1},8,["ModalStatus"]),r(I,{"-modal-status":h.value,onClose:e[14]||(e[14]=()=>{h.value=!1,l(a).reset()}),title:"Hapus Periode Putaran ini"},{modalBody:y(()=>e[28]||(e[28]=[t("div",{class:"form-group"},[t("div",null,[t("label",null,"Apakah Anda yakin ingin menghapus user ini?")])],-1)])),modalFunction:y(()=>[t("button",{type:"button",class:"btn-red-fordone btn-sm",onClick:j(R,["prevent"])}," Hapus ")]),_:1},8,["-modal-status"])]),_:1})],64)}}};export{Oe as default};
