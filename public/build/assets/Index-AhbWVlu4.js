import{j as n,A as se,f as T,g as L,o as k,t as u,n as oe,q as ne,C as re,k as q,h as ue,s as I,a as r,c as de,u as o,m as ie,w as F,b as t,e as pe,v,B as m,F as R,p as ce,d as H,D as C}from"./app-CZMwUBW3.js";import{G as ve}from"./GeneralLayout-BZDJ3jBS.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as fe}from"./debounce-CD1Fzea3.js";import{P as be}from"./Pagination-CXLjvPdH.js";import{M as N}from"./ModalBs-CCoKvqFs.js";import{t as ge,S as he,s as A}from"./multiselect-BgQLsUwX.js";import"./karlota-logo-Gt799DZz.js";const ye={__name:"FlashMessage",props:{toggleFlash:{type:Boolean,default:!1},flashObject:{type:Object,required:!1},types:{type:String,default:"bg-green-500"}},emits:["close"],setup(j,{emit:c}){const h=j,y=c,i=n(null),p=n("bg-green-500");let f=null;const b=function(){clearTimeout(f),f=setTimeout(()=>{y("close")},3e3)};return se(()=>{h.toggleFlash==!0&&(h.flashObject.error?(p.value="bg-red-700",i.value=h.flashObject.error):(i.value=h.flashObject.message,p.value="bg-green-700"),b())}),(x,P)=>j.toggleFlash?(k(),T("div",{key:0,class:oe(["p-4 rounded shadow-md mb-4 text-white left-[50%] top-[20px] max-w-[75%] fixed z-[1399]",p.value]),role:"alert"},u(i.value),3)):L("",!0)}},we=me(ye,[["__scopeId","data-v-8bac4d27"]]),ke={class:"mb-2 flex flex-wrap items-center justify-between"},xe={class:"flex items-center w-full md:w-full lg:w-auto"},Pe={class:"btn-success-fordone mr-2 mb-2 lg:mb-0",title:"Download"},Fe={class:"table-responsive-mobile overflow-x-auto"},Ce={class:"table border-2 mb-2 w-full",ref:"tabelUser",id:"tabel-user"},Te={class:"bg-info-fordone"},Ve={class:""},De={class:"search-header"},Be={class:"search-header"},Se={class:"search-header"},Ue={class:"search-header"},_e={class:"search-header"},Me={class:"search-header"},qe={class:"search-header"},je={class:"badge badge-info"},Oe={class:"text-center"},$e=["onClick"],Ae=["onClick"],Ee={key:1},Ie={class:"form-group"},Re={class:"mb-3 space-y-2"},He={class:"mb-3 space-y-2"},Ne={class:"mb-3 space-y-2"},Le={class:"mb-3 space-y-2"},ze={class:"mb-3 space-y-2"},Ge={class:"form-group"},at={__name:"Index",setup(j){const c=ne();var h=c.props.period.data;const y=n(h),i=n(!1),p=n(!1),f=n(!1),b=n(c.props.flash),x=n(null),P=n(null),V=n(null),D=n(null),B=n(null),S=n(null),U=n(null),l=re({_token:null,id:null,type:null,year:null,quarter:null,description:null,datepicker:{startDate:"",endDate:""}}),z=new Date().getFullYear(),G=Array.from({length:11},(s,e)=>z-e),Y=n({value:null,options:G.map(s=>({label:s.toString(),value:s.toString()}))});q(()=>c.props.flash,s=>{b.value=s});const J=()=>{f.value=!1,b.value={message:null,error:null}};q([{key:"type",valueFilter:x},{key:"year",valueFilter:P},{key:"quarter",valueFilter:V},{key:"description",valueFilter:D},{key:"status",valueFilter:B},{key:"started_at",valueFilter:S},{key:"ended_at",valueFilter:U}].map(s=>s.valueFilter),function(){_.value=1,W()});const W=fe(()=>{w()}),O=n(10),_=n(1),K=s=>{O.value=s,w()},Q=s=>{_.value=s,w()},$=n(c.props.countData);q(()=>c.props.countData,s=>{$.value=s});const E=ue(()=>y.value);q(()=>c.props.period.data,s=>{y.value=s});const w=async()=>{try{const s=await C.get(route("period.index"),{params:{currentPage:_.value,paginated:O.value,ArrayFilter:{type:x.value,year:P.value,quarter:V.value,description:D.value,status:B.value,started_at:S.value,ended_at:U.value},orderAttribute:d.value}});y.value=s.data.period.data,$.value=s.data.countData}catch(s){console.error("Error fetching data: ",s)}},d=n({before:null,label:null,value:"asc"}),g=s=>{d.value.label=s,d.value.before==null||d.value.before==s?d.value.value=="asc"?d.value.value="desc":d.value.value=="desc"?d.value.value=null:d.value.value="asc":d.value.value="asc",d.value.before=s,w()},X=async function(){const s=await C.get(route("token"));l._token=s.data,!l.processing&&l.post(route("period.store"),{onBefore:()=>{i.value=!1},onFinish:()=>{},onSuccess:()=>{b.value&&(f.value=!0),l.reset(),w()},onError:()=>{i.value=!0}})},Z=async()=>{const s=await C.get(route("token"));l._token=s.data,!l.processing&&l.delete(route("period.destroy",{id:l.id}),{onBefore:()=>{p.value=!1},onFinish:()=>{},onSuccess:()=>{b.value&&(f.value=!0),l.reset(),w()},onError:()=>{p.value=!0}})},ee=async s=>{try{const e=await C.get(route("period.fetch",{id:s}));l.id=e.data.data.id,l.type=e.data.data.type,l.year=e.data.data.year,l.quarter=e.data.data.quarter,l.description=e.data.data.description,l.datepicker.startDate=e.data.data.started_at+" 00:00:00",l.datepicker.endDate=e.data.data.ended_at+" 00:00:00",i.value=!0}catch(e){console.error(e)}},te=async s=>{try{const e=await C.get(route("period.fetch",{id:s}));l.id=e.data.data.id,l.type=e.data.data.type,l.year=e.data.data.year,l.quarter=e.data.data.quarter,l.description=e.data.data.description,p.value=!0}catch(e){console.error(e)}};return(s,e)=>{const M=I("font-awesome-icon"),ae=I("vue-tailwind-datepicker");return k(),T(R,null,[r(o(ie),{title:"Daftar Putaran"}),o(ge)?(k(),de(he,{key:0})):L("",!0),r(ve,null,{default:F(()=>[t("div",ke,[e[23]||(e[23]=t("div",{class:"text-xl font-bold w-full md:w-full lg:w-auto mb-2 md:mb-2 lg:mb-0"}," Jadwal Rekon PDRB / Putaran ",-1)),t("div",xe,[t("button",Pe,[r(M,{icon:"fa-solid fa-circle-down"})]),t("button",{onClick:e[0]||(e[0]=a=>i.value=!0),class:"btn-info-fordone mb-2 lg:mb-0"},[r(M,{icon:"fa-solid fa-plus"}),e[22]||(e[22]=pe(" Tambah Putaran Baru "))])])]),r(we,{toggleFlash:f.value,onClose:J,flashObject:b.value},null,8,["toggleFlash","flashObject"]),t("div",Fe,[t("table",Ce,[t("thead",null,[t("tr",Te,[e[24]||(e[24]=t("th",{class:"first-column"},"No.",-1)),t("th",{class:"text-center th-order tabel-width-20",onClick:e[1]||(e[1]=a=>g("type"))}," PDRB "),t("th",{class:"text-center th-order",onClick:e[2]||(e[2]=a=>g("year"))},"Tahun"),t("th",{class:"text-center th-order",onClick:e[3]||(e[3]=a=>g("quarter"))}," Triwulan "),t("th",{class:"text-center th-order",onClick:e[4]||(e[4]=a=>g("description"))}," Periode/Putaran "),t("th",{class:"text-center th-order tabel-width-8",onClick:e[5]||(e[5]=a=>g("status"))}," Status "),t("th",{class:"text-center th-order tabel-width-10",onClick:e[6]||(e[6]=a=>g("started_at"))}," Tanggal Mulai "),t("th",{class:"text-center th-order tabel-width-10",onClick:e[7]||(e[7]=a=>g("ended_at"))}," Tanggal Selesai "),e[25]||(e[25]=t("th",{class:"text-center th-order deleted"},"Edit/Hapus",-1))]),t("tr",Ve,[e[26]||(e[26]=t("td",{class:"search-header"},null,-1)),t("td",De,[v(t("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>x.value=a),type:"text",class:"input-fordone w-full"},null,512),[[m,x.value,void 0,{trim:!0}]])]),t("td",Be,[v(t("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>P.value=a),type:"text",class:"input-fordone w-full"},null,512),[[m,P.value,void 0,{trim:!0}]])]),t("td",Se,[v(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>V.value=a),type:"text",class:"input-fordone w-full"},null,512),[[m,V.value,void 0,{trim:!0}]])]),t("td",Ue,[v(t("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>D.value=a),type:"text",class:"input-fordone w-full"},null,512),[[m,D.value,void 0,{trim:!0}]])]),t("td",_e,[v(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>B.value=a),type:"text",class:"input-fordone w-full"},null,512),[[m,B.value,void 0,{trim:!0}]])]),t("td",Me,[v(t("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>S.value=a),type:"text",class:"input-fordone w-full"},null,512),[[m,S.value,void 0,{trim:!0}]])]),t("td",qe,[v(t("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>U.value=a),type:"text",class:"input-fordone w-full"},null,512),[[m,U.value,void 0,{trim:!0}]])]),e[27]||(e[27]=t("td",{class:"search-header deleted"},null,-1))])]),t("tbody",null,[y.value.length>0?(k(!0),T(R,{key:0},ce(E.value,a=>(k(),T("tr",{key:a.id},[t("td",null,u(a.number),1),t("td",null,u(a.type),1),t("td",null,u(a.year),1),t("td",null,u(a.quarter),1),t("td",null,u(a.description),1),t("td",null,[t("span",je,u(a.status),1)]),t("td",null,u(a.started_at),1),t("td",null,u(a.ended_at),1),t("td",Oe,[t("a",{onClick:le=>ee(a.id)},[r(M,{icon:"fa-solid fa-pencil",class:"edit-pen mx-2",title:"Cek/Edit"})],8,$e),t("a",{onClick:le=>te(a.id)},[r(M,{icon:"fa-solid fa-trash-can",class:"icon-trash-color mx-2",title:"Hapus"})],8,Ae)])]))),128)):(k(),T("tr",Ee,e[28]||(e[28]=[t("td",{colspan:"9",class:"text-center"},"Data Tidak Ada",-1)])))])],512)]),r(be,{"onUpdate:currentPage":Q,"onUpdate:showItems":K,"show-items":O.value,"total-items":$.value,"current-page":_.value,"current-show-items":E.value.length},null,8,["show-items","total-items","current-page","current-show-items"]),r(N,{ModalStatus:i.value,onClose:e[20]||(e[20]=a=>i.value=!1),title:"Tambah Putaran Baru",modalSize:"min-w-[40vw]",modalPosition:"items-start pt-5"},{modalBody:F(()=>[t("div",Ie,[t("div",Re,[e[29]||(e[29]=t("label",{for:"pdrb"},"Pilih PDRB",-1)),r(o(A),{modelValue:o(l).type,"onUpdate:modelValue":e[15]||(e[15]=a=>o(l).type=a),options:[{label:"Lapangan Usaha",value:"Lapangan Usaha"},{label:"Pengeluaran",value:"Pengeluaran"}],searchable:!0,placeholder:"-- Pilih PDRB--"},null,8,["modelValue"])]),t("div",He,[e[30]||(e[30]=t("label",{for:"tahun"},"Pilih Tahun",-1)),r(o(A),{modelValue:o(l).year,"onUpdate:modelValue":e[16]||(e[16]=a=>o(l).year=a),options:Y.value.options,searchable:!0,placeholder:"-- Pilih Tahun--"},null,8,["modelValue","options"])]),t("div",Ne,[e[31]||(e[31]=t("label",{for:"triwulan"},"Pilih Triwulan",-1)),r(o(A),{modelValue:o(l).quarter,"onUpdate:modelValue":e[17]||(e[17]=a=>o(l).quarter=a),options:[{label:"Triwulan 1",value:"1"},{label:"Triwulan 2",value:"2"},{label:"Triwulan 3",value:"3"},{label:"Triwulan 4",value:"4"}],searchable:!0,placeholder:"-- Pilih Triwulan--"},null,8,["modelValue"])]),t("div",Le,[e[32]||(e[32]=t("label",{for:"description"},"Putaran",-1)),v(t("input",{type:"text","onUpdate:modelValue":e[18]||(e[18]=a=>o(l).description=a),placeholder:"Isikan Putaran ke-",class:"input-fordone w-full"},null,512),[[m,o(l).description]])]),t("div",ze,[e[33]||(e[33]=t("label",{for:"daterange"},"Rentang Waktu",-1)),r(ae,{modelValue:o(l).datepicker,"onUpdate:modelValue":e[19]||(e[19]=a=>o(l).datepicker=a)},null,8,["modelValue"])])]),e[34]||(e[34]=t("div",{class:"text-center mt-3 text-red-900"},[t("label",null,"Apakah putaran sebelumnya sudah selesai?")],-1))]),modalFunction:F(()=>[t("button",{type:"button",class:"btn-success-fordone btn-sm",onClick:H(X,["prevent"])}," Simpan ")]),_:1},8,["ModalStatus"]),r(N,{"-modal-status":p.value,onClose:e[21]||(e[21]=()=>{p.value=!1,o(l).reset()}),title:"Hapus Periode Putaran ini"},{modalBody:F(()=>[t("div",Ge,[e[35]||(e[35]=t("div",null,[t("label",null,"Apakah Anda yakin ingin menghapus periode putaran ini?")],-1)),e[36]||(e[36]=t("div",null,[t("label",null,"Seluruh data yang terhubung ke data ini akan hilang")],-1)),t("div",null,u(o(l).type)+" "+u(o(l).year)+" "+u(o(l).quarter)+" "+u(o(l).description),1)])]),modalFunction:F(()=>[t("button",{type:"button",class:"btn-red-fordone btn-sm",onClick:H(Z,["prevent"])}," Hapus ")]),_:1},8,["-modal-status"])]),_:1})],64)}}};export{at as default};
